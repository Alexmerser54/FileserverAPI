
# Файловый сервер на Node.JS

Файловый сервер на фреймворке Nest.JS с CRUD операциями и простешей авторизацией

POST запросы принимают данные в формате JSON
## API Reference

#### Регистрация пользователя

```http
  POST /reg
```

| Параметр | Тип     | Описание                |
| :-------- | :------- | :------------------------- |
| `login` | `string` | **Обязательно**. Логин пользователя |
| `password` | `string` | **Обязательно**. Пароль пользователя |

###
#### Авторизоваться. Возвращает JWT

```http
  POST /login
```

| Параметр | Тип     | Описание                       |
| :-------- | :------- | :-------------------------------- |
| `login` | `string` | **Обязательно**. Логин пользователя |
| `password` | `string` | **Обязательно**. Пароль пользователя |

###

#### Получить данные о файловой системе.
#### Обязательная передача JWT в заголовке Authorization

```http
  GET /{filesystem}
```
##### Возвращаемые значения

| Параметр | Тип     | Описание                       |
| :-------- | :------- | :-------------------------------- |
| `id` | `number` |  ID файловой системы |
| `name` | `string` | Имя файловой системы `{filesystem}` |
| `maxSize` | `number` | Максимально допустимый размер файла (в Кб) |
| `extensions` | `string[]` | Массив допустимых расширений файлов |
| `files` | `File[]` | Массив файлов |

###

#### Получить данные о файле в файловой системе
#### Обязательная передача JWT в заголовке Authorization

```http
  GET /{filesystem}/{filename}
```
##### Возвращаемые значения (тип File)

| Параметр | Тип     | Описание                       |
| :-------- | :------- | :-------------------------------- |
| `name` | `number` |  Имя файла `{filename}`  |
| `size` | `string` | Пазмер файла (в Кб) |

###

#### Скачка файла {filename} из файловой системы {filesystem}
#### Обязательная передача JWT в заголовке Authorization

```http
  GET /{filesystem}/{filename}/download
```
#### Возвращаемые значения (тип File)
#### Обязательная передача JWT в заголовке Authorization

| Параметр | Тип     | Описание                       |
| :-------- | :------- | :-------------------------------- |
| `name` | `number` |  Имя файла `{filename}`  |
| `size` | `string` | Пазмер файла (в Кб) |

###

```http
  POST /{filesystem}/{filename}
```
#### Загрузка файла {filename} в файловую систему {filesystem}
#### Обязательная передача JWT в заголовке Authorization
#### Параметры (не в формате JSON)

| Параметр | Тип     | Описание                       |
| :-------- | :------- | :-------------------------------- |
| `file` | `multipart/form-data` |  Содержимое файла  |

#### Возвращаемые значения

| Параметр | Тип     | Описание                       |
| :-------- | :------- | :-------------------------------- |
| `fieldname` | `string` |  Название поле (всегда равно filed)  |
| `originalname` | `string` |  Имя файла  |
| `size` | `number` |  Размер файла (в Кб)  |

###

```http
  DELETE /{filesystem}/{filename}
```
#### Удаление файла {filename} из файловой системы {filesystem}
#### Обязательная передача JWT в заголовке Authorization
#### 
#### Возвращаемые значения (тип File)

| Параметр | Тип     | Описание                       |
| :-------- | :------- | :-------------------------------- |
| `name` | `number` |  Имя файла `{filename}`  |
| `size` | `string` | Пазмер файла (в Кб) |

###
## Развёртка

### Настройка .env

DATABASE_URL - сслыка для подключения БД в Prisma

FILESERVER_PATH - путь к папке, в которой будет расположена файловая система

SALT - соль для шифрования JWT

#### Для запуска приложения, выполните
```bash
  npm start
```


## TODO

- Реализовать шифрование паролей в БД и проверку хэшей при авторизации

- Добавить роли

- Написать исключения для различных сценариев (вместо HttpException)

